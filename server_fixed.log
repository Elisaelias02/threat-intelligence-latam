============================================================
AEGIS THREAT INTELLIGENCE LATAM - SISTEMA REAL
   Desarrollado por: Elisa Elias
   AEGIS Security Consulting
   Version: 3.0.0 - PRODUCCIÓN
============================================================
2025-07-22 03:35:31,448 - __main__ - INFO - Iniciando AEGIS Threat Intelligence System...
2025-07-22 03:35:31,451 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}}
2025-07-22 03:35:31,451 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "previousDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>"}
2025-07-22 03:35:31,451 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "serverHost": "localhost", "serverPort": 27017}
2025-07-22 03:35:31,452 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "687f070362760f3e5ba6ea53"}, "serverHost": "localhost", "serverPort": 27017}
2025-07-22 03:35:31,453 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "687f070362760f3e5ba6ea53"}}
2025-07-22 03:35:31,453 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "687f070362760f3e5ba6ea53"}, "remainingTimeMS": 4999}
2025-07-22 03:35:31,453 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 1.4344619703479111, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:35:31,454 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "previousDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:35:31,955 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.5466089933179319, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:35:31,955 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "previousDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:35:32,456 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.5303010111674666, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:35:32,456 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "previousDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:35:32,957 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.519751978572458, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:35:32,957 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "previousDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:35:33,458 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.5357200279831886, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:35:33,459 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "previousDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:35:33,959 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.5286840023472905, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:35:33,960 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "previousDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:35:34,460 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.46482100151479244, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:35:34,461 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "previousDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:35:34,961 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.4814799758605659, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:35:34,962 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "previousDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:35:35,462 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.5060840048827231, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:35:35,463 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "previousDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:35:35,964 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.5563219892792404, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:35:35,964 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "previousDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:35:36,464 - pymongo.serverSelection - DEBUG - {"message": "Server selection failed", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "clientId": {"$oid": "687f070362760f3e5ba6ea53"}, "failure": "\"localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)\""}
2025-07-22 03:35:36,465 - __main__ - WARNING - MongoDB no disponible: localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 5.0s, Topology Description: <TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>. Usando almacenamiento en memoria.
2025-07-22 03:35:36,465 - __main__ - INFO - Sistema profesional de Threat Intelligence inicializado
2025-07-22 03:35:36,468 - pymongo.topology - DEBUG - {"message": "Starting topology monitoring", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}}
2025-07-22 03:35:36,468 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "previousDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>"}
2025-07-22 03:35:36,468 - pymongo.topology - DEBUG - {"message": "Starting server monitoring", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "serverHost": "localhost", "serverPort": 27017}
2025-07-22 03:35:36,468 - pymongo.connection - DEBUG - {"message": "Connection pool created", "clientId": {"$oid": "687f070862760f3e5ba6ea54"}, "serverHost": "localhost", "serverPort": 27017}
2025-07-22 03:35:36,469 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 4.9450749647803605, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:35:36,469 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "previousDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:35:36,470 - pymongo.serverSelection - DEBUG - {"message": "Server selection started", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "687f070862760f3e5ba6ea54"}}
2025-07-22 03:35:36,470 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 1.1658360017463565, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:35:36,470 - pymongo.serverSelection - DEBUG - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "687f070862760f3e5ba6ea54"}, "remainingTimeMS": 4999}
2025-07-22 03:35:36,470 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "previousDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:35:36,971 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.26585202431306243, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:35:36,971 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "previousDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:35:37,471 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.2898219972848892, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:35:37,472 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "previousDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:35:37,972 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.6109200185164809, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:35:37,973 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "previousDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:35:38,473 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.28251297771930695, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:35:38,473 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "previousDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:35:38,974 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.30184799106791615, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:35:38,974 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "previousDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:35:39,475 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.3383859875611961, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:35:39,475 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "previousDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:35:39,975 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.3288760199211538, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:35:39,976 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "previousDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:35:40,477 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.6522290059365332, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:35:40,477 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "previousDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:35:40,977 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.39911101339384913, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:35:40,978 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "previousDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:35:41,478 - pymongo.serverSelection - DEBUG - {"message": "Server selection failed", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "clientId": {"$oid": "687f070862760f3e5ba6ea54"}, "failure": "\"localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)\""}
2025-07-22 03:35:41,478 - __main__ - WARNING - MongoDB no disponible: localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 5.0s, Topology Description: <TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>. Usando almacenamiento en memoria.
2025-07-22 03:35:41,479 - __main__ - INFO - Sistema profesional de Threat Intelligence inicializado

Conectando a fuentes de Threat Intelligence:
   FUENTES PROFESIONALES:
   - VirusTotal API (URLs/archivos maliciosos)
   - IBM X-Force Exchange API (Inteligencia corporativa)
   - OTX AlienVault API (Indicadores colaborativos)
   - Hybrid Analysis API (Análisis de malware)
   - MalwareBazaar API (Muestras de malware)
   - NVD API (Vulnerabilidades CVE)
   FUENTES COMPLEMENTARIAS:
   - OpenPhish (URLs de phishing)
   - PhishTank (URLs verificadas)
   - URLhaus (URLs de malware)
   - ThreatFox (IOCs verificados)
   - IP Blocklists (IPs maliciosas)

Estado de configuración de APIs:
   - VirusTotal: ✗ MODO DEMO
   - IBM X-Force: ✗ MODO DEMO
   - OTX AlienVault: ✗ MODO DEMO
   - Hybrid Analysis: ✗ MODO DEMO
   - NVD: ✗ MODO DEMO

   NOTA: Sistema funcionando en modo DEMO con datos realistas
   Para datos reales, configura las API keys en variables de entorno:
   - VIRUSTOTAL_API_KEY
   - IBM_XFORCE_API_KEY + IBM_XFORCE_PASSWORD
   - OTX_API_KEY
   - HYBRID_ANALYSIS_API_KEY
   - NVD_API_KEY (opcional)
2025-07-22 03:35:41,480 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 1.7488450394012034, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:35:41,486 - __main__ - INFO - === INICIANDO RECOLECCIÓN PROFESIONAL DE THREAT INTELLIGENCE ===
2025-07-22 03:35:41,487 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "previousDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:35:41,487 - __main__ - INFO - === INICIANDO RECOLECCIÓN PROFESIONAL DE THREAT INTELLIGENCE ===
2025-07-22 03:35:41,487 - __main__ - INFO - Recolectando desde VirusTotal...
2025-07-22 03:35:41,487 - __main__ - INFO - VirusTotal API key no configurada - generando datos demo
/workspace/app.py:1312: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  first_seen=datetime.utcnow() - timedelta(hours=random.randint(1, 48)),
/workspace/app.py:1313: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  last_seen=datetime.utcnow(),
2025-07-22 03:35:41,487 - __main__ - INFO - VirusTotal: 4 IOCs recolectados
2025-07-22 03:35:43,488 - __main__ - INFO - Recolectando desde IBM X-Force...
2025-07-22 03:35:43,488 - __main__ - INFO - IBM X-Force API credentials no configuradas - generando datos demo
/workspace/app.py:1426: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  first_seen=datetime.utcnow() - timedelta(hours=random.randint(6, 120)),
/workspace/app.py:1427: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  last_seen=datetime.utcnow(),
2025-07-22 03:35:43,488 - __main__ - INFO - IBM X-Force: 5 IOCs recolectados
2025-07-22 03:35:45,488 - __main__ - INFO - Recolectando desde OTX AlienVault...
2025-07-22 03:35:45,488 - __main__ - INFO - OTX API key no configurada - generando datos demo
/workspace/app.py:1564: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  first_seen=datetime.utcnow() - timedelta(hours=random.randint(1, 72)),
/workspace/app.py:1565: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  last_seen=datetime.utcnow(),
2025-07-22 03:35:45,489 - __main__ - INFO - OTX AlienVault: 5 IOCs recolectados
2025-07-22 03:35:46,472 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.41216204408556223, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:35:46,473 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "previousDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:35:47,489 - __main__ - INFO - Recolectando desde Hybrid Analysis...
2025-07-22 03:35:47,489 - __main__ - INFO - Hybrid Analysis API key no configurada - saltando
2025-07-22 03:35:47,489 - __main__ - INFO - Hybrid Analysis: 0 IOCs recolectados
2025-07-22 03:35:49,489 - __main__ - INFO - Recolectando desde MalwareBazaar...
2025-07-22 03:35:49,489 - __main__ - INFO - Consultando MalwareBazaar para IOCs...
2025-07-22 03:35:49,491 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): mb-api.abuse.ch:443
2025-07-22 03:35:49,903 - urllib3.connectionpool - DEBUG - https://mb-api.abuse.ch:443 "POST /api/v1/ HTTP/1.1" 401 0
/workspace/app.py:1714: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  first_seen=datetime.utcnow() - timedelta(hours=random.randint(1, 48)),
/workspace/app.py:1715: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  last_seen=datetime.utcnow(),
2025-07-22 03:35:49,904 - __main__ - INFO - MalwareBazaar: 5 IOCs recolectados
2025-07-22 03:35:51,490 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.3698520013131201, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:35:51,490 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "previousDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:35:51,904 - __main__ - INFO - Recolectando desde NVD...
2025-07-22 03:35:51,904 - __main__ - INFO - Consultando NVD para CVEs de los últimos 7 días...
/workspace/app.py:1188: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  end_date = datetime.utcnow()
2025-07-22 03:35:51,905 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): services.nvd.nist.gov:443
2025-07-22 03:35:52,221 - urllib3.connectionpool - DEBUG - https://services.nvd.nist.gov:443 "GET /rest/json/cves/2.0?pubStartDate=2025-07-15T03%3A35%3A51.000&pubEndDate=2025-07-22T03%3A35%3A51.000&resultsPerPage=100 HTTP/1.1" 200 None
2025-07-22 03:35:52,327 - __main__ - INFO - NVD: 15 CVEs recolectados
2025-07-22 03:35:52,329 - __main__ - INFO - NVD: 1 IOCs recolectados
2025-07-22 03:35:54,329 - __main__ - INFO - Correlacionando IOCs entre fuentes...
2025-07-22 03:35:54,329 - __main__ - INFO - Recolectando desde fuentes de scraping tradicionales...
2025-07-22 03:35:54,329 - __main__ - INFO - Scrapeando OpenPhish...
2025-07-22 03:35:54,330 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): openphish.com:443
2025-07-22 03:35:54,785 - urllib3.connectionpool - DEBUG - https://openphish.com:443 "GET /feed.txt HTTP/1.1" 302 None
2025-07-22 03:35:54,786 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): raw.githubusercontent.com:443
2025-07-22 03:35:54,799 - urllib3.connectionpool - DEBUG - https://raw.githubusercontent.com:443 "GET /openphish/public_feed/refs/heads/main/feed.txt HTTP/1.1" 200 6810
2025-07-22 03:35:54,799 - __main__ - INFO - OpenPhish: 300 URLs encontradas
/workspace/app.py:493: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  first_seen=datetime.utcnow(),
/workspace/app.py:494: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  last_seen=datetime.utcnow(),
2025-07-22 03:35:54,804 - __main__ - INFO - OpenPhish: 31 IOCs de LATAM recolectados
2025-07-22 03:35:56,475 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.3855639952234924, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:35:56,475 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "previousDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:35:56,804 - __main__ - INFO - Scrapeando PhishTank...
2025-07-22 03:35:56,805 - urllib3.connectionpool - DEBUG - Starting new HTTP connection (1): data.phishtank.com:80
2025-07-22 03:35:56,844 - urllib3.connectionpool - DEBUG - http://data.phishtank.com:80 "GET /data/online-valid.csv HTTP/1.1" 301 167
2025-07-22 03:35:56,844 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): data.phishtank.com:443
2025-07-22 03:35:56,881 - urllib3.connectionpool - DEBUG - https://data.phishtank.com:443 "GET /data/online-valid.csv HTTP/1.1" 302 None
2025-07-22 03:35:56,882 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): cdn.phishtank.com:443
2025-07-22 03:35:56,991 - urllib3.connectionpool - DEBUG - https://cdn.phishtank.com:443 "GET /datadumps/verified_online.csv?Expires=1753154824&Signature=IFB4OHWhQj33afKfWenlXRWaD1wIoH7riCXQG1OYutAlfr4QjI8cyn5gJx05DyfcePIn7pXYzxVg6Ww5iyyTX5dlNGsJRUQmEuOzGwiZO5Iaj73XnS4EV-i0aJzY-zgBbRTLjdGVAX9fj2Hgxsu8rqcrxFKgT0nVVCgIIp0~gllTQ15ZMz~mbVt5wzI-uR~eAXiS1hCdsa8D1KDssimdzW8TJ7w8vEyiVXkQOjxzf5cbcCCkMlqXKn5LPY4eXh40Llys~dBtmAB1zFlGzvHmUAyPojYtNQ~JZsDL0k269Wwv9zxbSi6SazdGBMObvINz33EvMBVdYxd9WAKjqE2riw__&Key-Pair-Id=APKAILB45UG3RB4CSOJA HTTP/1.1" 404 17993
2025-07-22 03:35:56,991 - __main__ - WARNING - HTTP 404 para http://data.phishtank.com/data/online-valid.csv
2025-07-22 03:35:57,006 - urllib3.connectionpool - DEBUG - http://data.phishtank.com:80 "GET /data/online-valid.csv HTTP/1.1" 301 167
2025-07-22 03:35:57,021 - urllib3.connectionpool - DEBUG - https://data.phishtank.com:443 "GET /data/online-valid.csv HTTP/1.1" 302 None
2025-07-22 03:35:57,040 - urllib3.connectionpool - DEBUG - https://cdn.phishtank.com:443 "GET /datadumps/verified_online.csv?Expires=1753154824&Signature=IFB4OHWhQj33afKfWenlXRWaD1wIoH7riCXQG1OYutAlfr4QjI8cyn5gJx05DyfcePIn7pXYzxVg6Ww5iyyTX5dlNGsJRUQmEuOzGwiZO5Iaj73XnS4EV-i0aJzY-zgBbRTLjdGVAX9fj2Hgxsu8rqcrxFKgT0nVVCgIIp0~gllTQ15ZMz~mbVt5wzI-uR~eAXiS1hCdsa8D1KDssimdzW8TJ7w8vEyiVXkQOjxzf5cbcCCkMlqXKn5LPY4eXh40Llys~dBtmAB1zFlGzvHmUAyPojYtNQ~JZsDL0k269Wwv9zxbSi6SazdGBMObvINz33EvMBVdYxd9WAKjqE2riw__&Key-Pair-Id=APKAILB45UG3RB4CSOJA HTTP/1.1" 404 17993
2025-07-22 03:35:57,040 - __main__ - WARNING - HTTP 404 para http://data.phishtank.com/data/online-valid.csv
2025-07-22 03:35:57,055 - urllib3.connectionpool - DEBUG - http://data.phishtank.com:80 "GET /data/online-valid.csv HTTP/1.1" 301 167
2025-07-22 03:35:57,075 - urllib3.connectionpool - DEBUG - https://data.phishtank.com:443 "GET /data/online-valid.csv HTTP/1.1" 302 None
2025-07-22 03:35:57,093 - urllib3.connectionpool - DEBUG - https://cdn.phishtank.com:443 "GET /datadumps/verified_online.csv?Expires=1753154824&Signature=IFB4OHWhQj33afKfWenlXRWaD1wIoH7riCXQG1OYutAlfr4QjI8cyn5gJx05DyfcePIn7pXYzxVg6Ww5iyyTX5dlNGsJRUQmEuOzGwiZO5Iaj73XnS4EV-i0aJzY-zgBbRTLjdGVAX9fj2Hgxsu8rqcrxFKgT0nVVCgIIp0~gllTQ15ZMz~mbVt5wzI-uR~eAXiS1hCdsa8D1KDssimdzW8TJ7w8vEyiVXkQOjxzf5cbcCCkMlqXKn5LPY4eXh40Llys~dBtmAB1zFlGzvHmUAyPojYtNQ~JZsDL0k269Wwv9zxbSi6SazdGBMObvINz33EvMBVdYxd9WAKjqE2riw__&Key-Pair-Id=APKAILB45UG3RB4CSOJA HTTP/1.1" 404 17993
2025-07-22 03:35:57,094 - __main__ - WARNING - HTTP 404 para http://data.phishtank.com/data/online-valid.csv
2025-07-22 03:35:57,094 - __main__ - ERROR - No se pudo obtener datos de PhishTank
2025-07-22 03:35:59,094 - __main__ - INFO - Scrapeando URLhaus...
2025-07-22 03:35:59,095 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): urlhaus.feodotracker.abuse.ch:443
2025-07-22 03:35:59,117 - __main__ - WARNING - Error en request a https://urlhaus.feodotracker.abuse.ch/downloads/csv_recent/: HTTPSConnectionPool(host='urlhaus.feodotracker.abuse.ch', port=443): Max retries exceeded with url: /downloads/csv_recent/ (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7f6a7c11a5d0>: Failed to resolve 'urlhaus.feodotracker.abuse.ch' ([Errno -2] Name or service not known)"))
2025-07-22 03:36:00,118 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (2): urlhaus.feodotracker.abuse.ch:443
2025-07-22 03:36:00,142 - __main__ - WARNING - Error en request a https://urlhaus.feodotracker.abuse.ch/downloads/csv_recent/: HTTPSConnectionPool(host='urlhaus.feodotracker.abuse.ch', port=443): Max retries exceeded with url: /downloads/csv_recent/ (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7f6a7c11a850>: Failed to resolve 'urlhaus.feodotracker.abuse.ch' ([Errno -2] Name or service not known)"))
2025-07-22 03:36:01,493 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.3581589553505182, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:36:01,493 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "previousDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:36:02,142 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (3): urlhaus.feodotracker.abuse.ch:443
2025-07-22 03:36:02,147 - __main__ - WARNING - Error en request a https://urlhaus.feodotracker.abuse.ch/downloads/csv_recent/: HTTPSConnectionPool(host='urlhaus.feodotracker.abuse.ch', port=443): Max retries exceeded with url: /downloads/csv_recent/ (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7f6a7c119810>: Failed to resolve 'urlhaus.feodotracker.abuse.ch' ([Errno -2] Name or service not known)"))
2025-07-22 03:36:02,147 - __main__ - ERROR - No se pudo obtener datos de URLhaus
2025-07-22 03:36:04,147 - __main__ - INFO - Creando campañas basadas en IOCs profesionales...
/workspace/app.py:979: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  campaign_id = hashlib.md5(f"{campaign_name}_{datetime.utcnow().date()}_{source}".encode()).hexdigest()
2025-07-22 03:36:04,148 - __main__ - INFO - === RECOLECCIÓN PROFESIONAL COMPLETADA ===
2025-07-22 03:36:04,148 - __main__ - INFO - IOCs totales: 51
2025-07-22 03:36:04,148 - __main__ - INFO - Campañas creadas: 12
2025-07-22 03:36:04,148 - __main__ - DEBUG - Campaña almacenada en memoria: Campaña Phishing - Virustotal (total: 1)
2025-07-22 03:36:04,148 - __main__ - INFO - Campaña almacenada: Campaña Phishing - Virustotal (2 IOCs)
2025-07-22 03:36:04,148 - __main__ - DEBUG - Campaña almacenada en memoria: Campaña C2 - Virustotal (total: 2)
2025-07-22 03:36:04,148 - __main__ - INFO - Campaña almacenada: Campaña C2 - Virustotal (1 IOCs)
2025-07-22 03:36:04,148 - __main__ - DEBUG - Campaña almacenada en memoria: Campaña Malware - Virustotal (total: 3)
2025-07-22 03:36:04,148 - __main__ - INFO - Campaña almacenada: Campaña Malware - Virustotal (1 IOCs)
2025-07-22 03:36:04,148 - __main__ - DEBUG - Campaña almacenada en memoria: Campaña Phishing - Ibm (total: 4)
2025-07-22 03:36:04,148 - __main__ - INFO - Campaña almacenada: Campaña Phishing - Ibm (3 IOCs)
2025-07-22 03:36:04,148 - __main__ - DEBUG - Campaña almacenada en memoria: Campaña C2 - Ibm (total: 5)
2025-07-22 03:36:04,148 - __main__ - INFO - Campaña almacenada: Campaña C2 - Ibm (1 IOCs)
2025-07-22 03:36:04,148 - __main__ - DEBUG - Campaña almacenada en memoria: Campaña Malware - Ibm (total: 6)
2025-07-22 03:36:04,148 - __main__ - INFO - Campaña almacenada: Campaña Malware - Ibm (1 IOCs)
2025-07-22 03:36:04,148 - __main__ - DEBUG - Campaña almacenada en memoria: Campaña Phishing - Otx (total: 7)
2025-07-22 03:36:04,148 - __main__ - INFO - Campaña almacenada: Campaña Phishing - Otx (3 IOCs)
2025-07-22 03:36:04,149 - __main__ - DEBUG - Campaña almacenada en memoria: Campaña C2 - Otx (total: 8)
2025-07-22 03:36:04,149 - __main__ - INFO - Campaña almacenada: Campaña C2 - Otx (1 IOCs)
2025-07-22 03:36:04,149 - __main__ - DEBUG - Campaña almacenada en memoria: Campaña Malware - Otx (total: 9)
2025-07-22 03:36:04,149 - __main__ - INFO - Campaña almacenada: Campaña Malware - Otx (1 IOCs)
2025-07-22 03:36:04,149 - __main__ - DEBUG - Campaña almacenada en memoria: Campaña Grandoreiro - Malware (total: 10)
2025-07-22 03:36:04,149 - __main__ - INFO - Campaña almacenada: Campaña Grandoreiro - Malware (5 IOCs)
2025-07-22 03:36:04,149 - __main__ - DEBUG - Campaña almacenada en memoria: Campaña Vulnerability - Nvd (total: 11)
2025-07-22 03:36:04,149 - __main__ - INFO - Campaña almacenada: Campaña Vulnerability - Nvd (1 IOCs)
2025-07-22 03:36:04,149 - __main__ - DEBUG - Campaña almacenada en memoria: Campaña Phishing - Openphish (total: 12)
2025-07-22 03:36:04,150 - __main__ - INFO - Campaña almacenada: Campaña Phishing - Openphish (31 IOCs)

Sistema inicializado correctamente:
   Campañas detectadas: 12
   IOCs recolectados: 51
   Países afectados: 7
   Alertas críticas: 2
   Familias de malware: grandoreiro, javali, mekotio, amavaldo, casbaneiro

Dashboard disponible en: http://localhost:5000
   Sistema de monitoreo en tiempo real activado
   Fuentes actualizándose automáticamente
2025-07-22 03:36:04,150 - __main__ - INFO - Iniciando servidor web del sistema AEGIS...
 * Serving Flask app 'app'
 * Debug mode: off
2025-07-22 03:36:04,151 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://172.30.0.2:5000
2025-07-22 03:36:04,152 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-07-22 03:36:06,477 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.35658502019941807, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:36:06,478 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "previousDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:36:11,496 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.3756379592232406, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:36:11,497 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "previousDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:36:16,479 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.3867599880322814, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:36:16,480 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "previousDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:36:21,500 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.3784130094572902, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:36:21,500 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "previousDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:36:24,771 - werkzeug - INFO - 127.0.0.1 - - [22/Jul/2025 03:36:24] "GET /api/stats HTTP/1.1" 200 -
2025-07-22 03:36:26,482 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.3251880407333374, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:36:26,482 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "previousDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:36:31,503 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.31422701431438327, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:36:31,503 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "previousDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:36:31,565 - __main__ - DEBUG - Buscando campañas en memoria. Total disponibles: 12
2025-07-22 03:36:31,565 - __main__ - DEBUG - Campañas después de filtros: 12
2025-07-22 03:36:31,565 - werkzeug - INFO - 127.0.0.1 - - [22/Jul/2025 03:36:31] "GET /api/campaigns HTTP/1.1" 200 -
2025-07-22 03:36:36,485 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.39226101944223046, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:36:36,485 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "previousDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:36:37,883 - __main__ - DEBUG - Buscando campañas en memoria. Total disponibles: 12
2025-07-22 03:36:37,883 - __main__ - DEBUG - Campañas después de filtros: 12
/workspace/app.py:2535: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  'timestamp': datetime.utcnow().isoformat(),
/workspace/app.py:2497: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  'timestamp': datetime.utcnow().isoformat(),
/workspace/app.py:2511: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  'timestamp': datetime.utcnow().isoformat(),
/workspace/app.py:2524: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  'timestamp': datetime.utcnow().isoformat(),
2025-07-22 03:36:37,884 - werkzeug - INFO - 127.0.0.1 - - [22/Jul/2025 03:36:37] "GET /api/alerts HTTP/1.1" 200 -
2025-07-22 03:36:41,506 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.3448229981586337, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:36:41,506 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070862760f3e5ba6ea54"}, "previousDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070862760f3e5ba6ea54, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
2025-07-22 03:36:46,488 - pymongo.topology - DEBUG - {"message": "Server heartbeat failed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "serverHost": "localhost", "serverPort": 27017, "awaited": false, "durationMS": 0.3182259970344603, "failure": "\"AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')\""}
2025-07-22 03:36:46,488 - pymongo.topology - DEBUG - {"message": "Topology description changed", "topologyId": {"$oid": "687f070362760f3e5ba6ea53"}, "previousDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>", "newDescription": "<TopologyDescription id: 687f070362760f3e5ba6ea53, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>"}
