============================================================
AEGIS THREAT INTELLIGENCE LATAM - SISTEMA REAL
   Desarrollado por: Elisa Elias
   AEGIS Security Consulting
   Version: 3.0.0 - PRODUCCIÓN
============================================================
2025-07-22 04:32:09,828 - __main__ - INFO - Iniciando AEGIS Threat Intelligence System...
2025-07-22 04:32:14,839 - __main__ - WARNING - MongoDB no disponible: localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 5.0s, Topology Description: <TopologyDescription id: 687f1449bcf3931439e951cb, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>. Usando almacenamiento en memoria.
2025-07-22 04:32:14,839 - __main__ - INFO - Sistema profesional de Threat Intelligence inicializado
2025-07-22 04:32:19,848 - __main__ - WARNING - MongoDB no disponible: localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms), Timeout: 5.0s, Topology Description: <TopologyDescription id: 687f144ebcf3931439e951cc, topology_type: Unknown, servers: [<ServerDescription ('localhost', 27017) server_type: Unknown, rtt: None, error=AutoReconnect('localhost:27017: [Errno 111] Connection refused (configured timeouts: socketTimeoutMS: 20000.0ms, connectTimeoutMS: 20000.0ms)')>]>. Usando almacenamiento en memoria.
2025-07-22 04:32:19,849 - __main__ - INFO - Sistema profesional de Threat Intelligence inicializado

Conectando a fuentes de Threat Intelligence:
   FUENTES PROFESIONALES:
   - VirusTotal API (URLs/archivos maliciosos)
   - IBM X-Force Exchange API (Inteligencia corporativa)
   - OTX AlienVault API (Indicadores colaborativos)
   - Hybrid Analysis API (Análisis de malware)
   - MalwareBazaar API (Muestras de malware)
   - NVD API (Vulnerabilidades CVE)
   FUENTES COMPLEMENTARIAS:
   - OpenPhish (URLs de phishing)
   - PhishTank (URLs verificadas)
   - URLhaus (URLs de malware)
   - ThreatFox (IOCs verificados)
   - IP Blocklists (IPs maliciosas)

Estado de configuración de APIs:
   - VirusTotal: ✗ MODO DEMO
   - IBM X-Force: ✗ MODO DEMO
   - OTX AlienVault: ✗ MODO DEMO
   - Hybrid Analysis: ✗ MODO DEMO
   - NVD: ✗ MODO DEMO

   NOTA: Sistema funcionando en modo DEMO con datos realistas
   Para datos reales, configura las API keys en variables de entorno:
   - VIRUSTOTAL_API_KEY
   - IBM_XFORCE_API_KEY + IBM_XFORCE_PASSWORD
   - OTX_API_KEY
   - HYBRID_ANALYSIS_API_KEY
   - NVD_API_KEY (opcional)
2025-07-22 04:32:19,849 - __main__ - INFO - === INICIANDO RECOLECCIÓN PROFESIONAL DE THREAT INTELLIGENCE ===
2025-07-22 04:32:19,849 - __main__ - INFO - === INICIANDO RECOLECCIÓN PROFESIONAL DE THREAT INTELLIGENCE ===
2025-07-22 04:32:19,849 - __main__ - INFO - Recolectando desde VirusTotal...
2025-07-22 04:32:19,849 - __main__ - INFO - VirusTotal API key no configurada - generando datos demo
/workspace/app.py:1312: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  first_seen=datetime.utcnow() - timedelta(hours=random.randint(1, 48)),
/workspace/app.py:1313: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  last_seen=datetime.utcnow(),
2025-07-22 04:32:19,849 - __main__ - INFO - VirusTotal: 4 IOCs recolectados
2025-07-22 04:32:21,849 - __main__ - INFO - Recolectando desde IBM X-Force...
2025-07-22 04:32:21,849 - __main__ - INFO - IBM X-Force API credentials no configuradas - generando datos demo
/workspace/app.py:1426: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  first_seen=datetime.utcnow() - timedelta(hours=random.randint(6, 120)),
/workspace/app.py:1427: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  last_seen=datetime.utcnow(),
2025-07-22 04:32:21,849 - __main__ - INFO - IBM X-Force: 5 IOCs recolectados
2025-07-22 04:32:23,850 - __main__ - INFO - Recolectando desde OTX AlienVault...
2025-07-22 04:32:23,850 - __main__ - INFO - OTX API key no configurada - generando datos demo
/workspace/app.py:1564: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  first_seen=datetime.utcnow() - timedelta(hours=random.randint(1, 72)),
/workspace/app.py:1565: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  last_seen=datetime.utcnow(),
2025-07-22 04:32:23,850 - __main__ - INFO - OTX AlienVault: 5 IOCs recolectados
2025-07-22 04:32:25,850 - __main__ - INFO - Recolectando desde Hybrid Analysis...
2025-07-22 04:32:25,850 - __main__ - INFO - Hybrid Analysis API key no configurada - saltando
2025-07-22 04:32:25,850 - __main__ - INFO - Hybrid Analysis: 0 IOCs recolectados
2025-07-22 04:32:27,850 - __main__ - INFO - Recolectando desde MalwareBazaar...
2025-07-22 04:32:27,851 - __main__ - INFO - Consultando MalwareBazaar para IOCs...
/workspace/app.py:1714: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  first_seen=datetime.utcnow() - timedelta(hours=random.randint(1, 48)),
/workspace/app.py:1715: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  last_seen=datetime.utcnow(),
2025-07-22 04:32:28,285 - __main__ - INFO - MalwareBazaar: 5 IOCs recolectados
2025-07-22 04:32:30,285 - __main__ - INFO - Recolectando desde NVD...
2025-07-22 04:32:30,285 - __main__ - INFO - Consultando NVD para CVEs de los últimos 7 días...
/workspace/app.py:1188: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  end_date = datetime.utcnow()
2025-07-22 04:32:30,622 - __main__ - INFO - NVD: 15 CVEs recolectados
2025-07-22 04:32:30,624 - __main__ - INFO - NVD: 1 IOCs recolectados
2025-07-22 04:32:32,624 - __main__ - INFO - Correlacionando IOCs entre fuentes...
2025-07-22 04:32:32,625 - __main__ - INFO - Recolectando desde fuentes de scraping tradicionales...
2025-07-22 04:32:32,625 - __main__ - INFO - Scrapeando OpenPhish...
2025-07-22 04:32:33,128 - __main__ - INFO - OpenPhish: 300 URLs encontradas
/workspace/app.py:493: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  first_seen=datetime.utcnow(),
/workspace/app.py:494: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  last_seen=datetime.utcnow(),
2025-07-22 04:32:33,132 - __main__ - INFO - OpenPhish: 31 IOCs de LATAM recolectados
2025-07-22 04:32:35,133 - __main__ - INFO - Scrapeando PhishTank...
2025-07-22 04:32:35,394 - __main__ - WARNING - HTTP 404 para http://data.phishtank.com/data/online-valid.csv
2025-07-22 04:32:35,448 - __main__ - WARNING - HTTP 404 para http://data.phishtank.com/data/online-valid.csv
2025-07-22 04:32:35,494 - __main__ - WARNING - HTTP 404 para http://data.phishtank.com/data/online-valid.csv
2025-07-22 04:32:35,494 - __main__ - ERROR - No se pudo obtener datos de PhishTank
2025-07-22 04:32:37,494 - __main__ - INFO - Scrapeando URLhaus...
2025-07-22 04:32:37,517 - __main__ - WARNING - Error en request a https://urlhaus.feodotracker.abuse.ch/downloads/csv_recent/: HTTPSConnectionPool(host='urlhaus.feodotracker.abuse.ch', port=443): Max retries exceeded with url: /downloads/csv_recent/ (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7f58adbe6e90>: Failed to resolve 'urlhaus.feodotracker.abuse.ch' ([Errno -2] Name or service not known)"))
2025-07-22 04:32:38,558 - __main__ - WARNING - Error en request a https://urlhaus.feodotracker.abuse.ch/downloads/csv_recent/: HTTPSConnectionPool(host='urlhaus.feodotracker.abuse.ch', port=443): Max retries exceeded with url: /downloads/csv_recent/ (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7f58adbe6710>: Failed to resolve 'urlhaus.feodotracker.abuse.ch' ([Errno -2] Name or service not known)"))
2025-07-22 04:32:40,562 - __main__ - WARNING - Error en request a https://urlhaus.feodotracker.abuse.ch/downloads/csv_recent/: HTTPSConnectionPool(host='urlhaus.feodotracker.abuse.ch', port=443): Max retries exceeded with url: /downloads/csv_recent/ (Caused by NameResolutionError("<urllib3.connection.HTTPSConnection object at 0x7f58adbe5950>: Failed to resolve 'urlhaus.feodotracker.abuse.ch' ([Errno -2] Name or service not known)"))
2025-07-22 04:32:40,562 - __main__ - ERROR - No se pudo obtener datos de URLhaus
2025-07-22 04:32:42,562 - __main__ - INFO - Creando campañas basadas en IOCs profesionales...
/workspace/app.py:979: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  campaign_id = hashlib.md5(f"{campaign_name}_{datetime.utcnow().date()}_{source}".encode()).hexdigest()
2025-07-22 04:32:42,563 - __main__ - INFO - === RECOLECCIÓN PROFESIONAL COMPLETADA ===
2025-07-22 04:32:42,563 - __main__ - INFO - IOCs totales: 51
2025-07-22 04:32:42,563 - __main__ - INFO - Campañas creadas: 12
2025-07-22 04:32:42,563 - __main__ - INFO - Campaña almacenada: Campaña Phishing - Virustotal (2 IOCs)
2025-07-22 04:32:42,563 - __main__ - INFO - Campaña almacenada: Campaña C2 - Virustotal (1 IOCs)
2025-07-22 04:32:42,563 - __main__ - INFO - Campaña almacenada: Campaña Malware - Virustotal (1 IOCs)
2025-07-22 04:32:42,563 - __main__ - INFO - Campaña almacenada: Campaña Phishing - Ibm (3 IOCs)
2025-07-22 04:32:42,563 - __main__ - INFO - Campaña almacenada: Campaña C2 - Ibm (1 IOCs)
2025-07-22 04:32:42,563 - __main__ - INFO - Campaña almacenada: Campaña Malware - Ibm (1 IOCs)
2025-07-22 04:32:42,563 - __main__ - INFO - Campaña almacenada: Campaña Phishing - Otx (3 IOCs)
2025-07-22 04:32:42,564 - __main__ - INFO - Campaña almacenada: Campaña C2 - Otx (1 IOCs)
2025-07-22 04:32:42,564 - __main__ - INFO - Campaña almacenada: Campaña Malware - Otx (1 IOCs)
2025-07-22 04:32:42,564 - __main__ - INFO - Campaña almacenada: Campaña Grandoreiro - Malware (5 IOCs)
2025-07-22 04:32:42,564 - __main__ - INFO - Campaña almacenada: Campaña Vulnerability - Nvd (1 IOCs)
2025-07-22 04:32:42,565 - __main__ - INFO - Campaña almacenada: Campaña Phishing - Openphish (31 IOCs)

Sistema inicializado correctamente:
   Campañas detectadas: 12
   IOCs recolectados: 51
   Países afectados: 7
   Alertas críticas: 2
   Familias de malware: grandoreiro, javali, mekotio, casbaneiro, amavaldo

Dashboard disponible en: http://localhost:5000
   Sistema de monitoreo en tiempo real activado
   Fuentes actualizándose automáticamente
2025-07-22 04:32:42,565 - __main__ - INFO - Iniciando servidor web del sistema AEGIS...
 * Serving Flask app 'app'
 * Debug mode: off
2025-07-22 04:32:42,566 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://172.30.0.2:5000
2025-07-22 04:32:42,566 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-07-22 04:32:44,400 - werkzeug - INFO - 127.0.0.1 - - [22/Jul/2025 04:32:44] "GET /api/stats HTTP/1.1" 200 -
2025-07-22 04:32:49,565 - werkzeug - INFO - 127.0.0.1 - - [22/Jul/2025 04:32:49] "GET / HTTP/1.1" 200 -
2025-07-22 04:33:07,732 - werkzeug - INFO - 127.0.0.1 - - [22/Jul/2025 04:33:07] "GET / HTTP/1.1" 200 -
2025-07-22 04:33:37,509 - werkzeug - INFO - 127.0.0.1 - - [22/Jul/2025 04:33:37] "GET / HTTP/1.1" 200 -
2025-07-22 04:34:11,367 - werkzeug - INFO - 127.0.0.1 - - [22/Jul/2025 04:34:11] "GET / HTTP/1.1" 200 -
2025-07-22 04:34:27,510 - werkzeug - INFO - 127.0.0.1 - - [22/Jul/2025 04:34:27] "GET /api/stats HTTP/1.1" 200 -
2025-07-22 04:34:27,527 - werkzeug - INFO - 127.0.0.1 - - [22/Jul/2025 04:34:27] "GET /api/campaigns HTTP/1.1" 200 -
/workspace/app.py:2535: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  'timestamp': datetime.utcnow().isoformat(),
/workspace/app.py:2497: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  'timestamp': datetime.utcnow().isoformat(),
/workspace/app.py:2511: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  'timestamp': datetime.utcnow().isoformat(),
/workspace/app.py:2524: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  'timestamp': datetime.utcnow().isoformat(),
2025-07-22 04:34:27,542 - werkzeug - INFO - 127.0.0.1 - - [22/Jul/2025 04:34:27] "GET /api/alerts HTTP/1.1" 200 -
